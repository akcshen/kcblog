(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{455:function(s,t,a){"use strict";a.r(t);var n=a(8),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"统一代理服务器项目总结-一个强大的node-js代理解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#统一代理服务器项目总结-一个强大的node-js代理解决方案"}},[s._v("#")]),s._v(" 统一代理服务器项目总结：一个强大的Node.js代理解决方案")]),s._v(" "),t("h2",{attrs:{id:"项目概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目概述"}},[s._v("#")]),s._v(" 项目概述")]),s._v(" "),t("p",[s._v("最近我开发并部署了一个功能强大的统一代理服务器，这是一个基于Node.js和Express的通用代理解决方案。该项目的主要目标是提供一个统一的接口来代理多个不同的API服务，通过简单的key参数来动态选择目标服务器。")]),s._v(" "),t("p",[t("strong",[s._v("线上访问地址：")]),s._v(" "),t("a",{attrs:{href:"http://birth.kcshen.cn:3002/proxy/huoshan/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://birth.kcshen.cn:3002/proxy/huoshan/"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"核心功能特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#核心功能特性"}},[s._v("#")]),s._v(" 核心功能特性")]),s._v(" "),t("h3",{attrs:{id:"🎯-统一代理路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🎯-统一代理路由"}},[s._v("#")]),s._v(" 🎯 统一代理路由")]),s._v(" "),t("ul",[t("li",[s._v("使用 "),t("code",[s._v("/proxy/{key}/*")]),s._v(" 格式的统一路由")]),s._v(" "),t("li",[s._v("通过key参数动态选择不同的目标服务器")]),s._v(" "),t("li",[s._v("支持所有HTTP方法：GET、POST、PUT、DELETE、PATCH等")])]),s._v(" "),t("h3",{attrs:{id:"🔄-多种key传递方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🔄-多种key传递方式"}},[s._v("#")]),s._v(" 🔄 多种key传递方式")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("URL参数方式")]),s._v("（推荐）："),t("code",[s._v("/proxy/users/users/1")])]),s._v(" "),t("li",[t("strong",[s._v("查询参数方式")]),s._v("："),t("code",[s._v("/proxy/users/1?key=users")])]),s._v(" "),t("li",[t("strong",[s._v("请求体方式")]),s._v("：在POST请求体中包含key字段")])]),s._v(" "),t("h3",{attrs:{id:"🛡️-完善的中间件支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🛡️-完善的中间件支持"}},[s._v("#")]),s._v(" 🛡️ 完善的中间件支持")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("CORS处理")]),s._v("：自动解决跨域问题")]),s._v(" "),t("li",[t("strong",[s._v("请求日志")]),s._v("：详细的请求和响应日志记录")]),s._v(" "),t("li",[t("strong",[s._v("错误处理")]),s._v("：完善的错误处理和用户友好的错误信息")]),s._v(" "),t("li",[t("strong",[s._v("安全防护")]),s._v("：使用helmet、rate-limit等安全中间件")])]),s._v(" "),t("h3",{attrs:{id:"📊-监控和健康检查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#📊-监控和健康检查"}},[s._v("#")]),s._v(" 📊 监控和健康检查")]),s._v(" "),t("ul",[t("li",[s._v("健康检查接口："),t("code",[s._v("/health")])]),s._v(" "),t("li",[s._v("可用key列表："),t("code",[s._v("/proxy/keys")])]),s._v(" "),t("li",[s._v("详细的请求日志和错误追踪")])]),s._v(" "),t("h2",{attrs:{id:"技术架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#技术架构"}},[s._v("#")]),s._v(" 技术架构")]),s._v(" "),t("h3",{attrs:{id:"核心技术栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#核心技术栈"}},[s._v("#")]),s._v(" 核心技术栈")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Node.js")]),s._v(" - 运行时环境")]),s._v(" "),t("li",[t("strong",[s._v("Express.js")]),s._v(" - Web框架")]),s._v(" "),t("li",[t("strong",[s._v("Axios")]),s._v(" - HTTP客户端")]),s._v(" "),t("li",[t("strong",[s._v("PM2")]),s._v(" - 进程管理")]),s._v(" "),t("li",[t("strong",[s._v("Nginx")]),s._v(" - 反向代理（可选）")])]),s._v(" "),t("h3",{attrs:{id:"项目结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目结构"}},[s._v("#")]),s._v(" 项目结构")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Agent/\n├── server.js              # 主服务器文件\n├── proxy-middleware.js    # 核心代理中间件\n├── package.json          # 项目配置\n├── ecosystem.config.js   # PM2配置文件\n├── deploy.sh            # 部署脚本\n├── DEPLOYMENT.md        # 部署文档\n├── nginx/               # Nginx配置\n└── README.md           # 项目文档\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"核心代码解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#核心代码解析"}},[s._v("#")]),s._v(" 核心代码解析")]),s._v(" "),t("h4",{attrs:{id:"代理中间件实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代理中间件实现"}},[s._v("#")]),s._v(" 代理中间件实现")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createProxyMiddleware")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("urlMap")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1. 获取key参数")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("params"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2. 验证key并获取目标URL")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" targetUrl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" urlMap"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. 构建完整的目标URL")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fullUrl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("targetUrl"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("requestPath"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4. 转发请求")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" response "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("axios")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("requestConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5. 返回响应")]),s._v("\n        res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h4",{attrs:{id:"url映射配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#url映射配置"}},[s._v("#")]),s._v(" URL映射配置")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" urlMap "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v("'huoshan'")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://openspeech.bytedance.com/api/v1/tts'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以轻松添加更多API映射")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"部署方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署方案"}},[s._v("#")]),s._v(" 部署方案")]),s._v(" "),t("h3",{attrs:{id:"生产环境部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生产环境部署"}},[s._v("#")]),s._v(" 生产环境部署")]),s._v(" "),t("p",[s._v("项目使用PM2进行进程管理，支持以下特性：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("集群模式")]),s._v("：利用所有CPU核心")]),s._v(" "),t("li",[t("strong",[s._v("自动重启")]),s._v("：进程崩溃时自动重启")]),s._v(" "),t("li",[t("strong",[s._v("日志管理")]),s._v("：分离的访问日志和错误日志")]),s._v(" "),t("li",[t("strong",[s._v("内存限制")]),s._v("：防止内存泄漏")]),s._v(" "),t("li",[t("strong",[s._v("开机自启")]),s._v("：系统重启后自动启动")])]),s._v(" "),t("h3",{attrs:{id:"部署脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署脚本"}},[s._v("#")]),s._v(" 部署脚本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开发环境部署")]),s._v("\n./deploy.sh dev\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生产环境部署")]),s._v("\n./deploy.sh prod\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看状态")]),s._v("\n./deploy.sh status\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"监控和维护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#监控和维护"}},[s._v("#")]),s._v(" 监控和维护")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("健康检查")]),s._v("："),t("code",[s._v("curl http://birth.kcshen.cn:3002/health")])]),s._v(" "),t("li",[t("strong",[s._v("日志查看")]),s._v("："),t("code",[s._v("pm2 logs proxy-server-prod")])]),s._v(" "),t("li",[t("strong",[s._v("性能监控")]),s._v("："),t("code",[s._v("pm2 monit")])])]),s._v(" "),t("h2",{attrs:{id:"使用示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),t("h3",{attrs:{id:"基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[s._v("#")]),s._v(" 基本使用")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取可用的key列表")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://birth.kcshen.cn:3002/proxy/keys\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用代理访问API")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://birth.kcshen.cn:3002/proxy/huoshan/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"javascript-node-js集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript-node-js集成"}},[s._v("#")]),s._v(" JavaScript/Node.js集成")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" axios "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'axios'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 通过代理访问API")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" response "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" axios"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://birth.kcshen.cn:3002/proxy/huoshan/'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nconsole"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"前端集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前端集成"}},[s._v("#")]),s._v(" 前端集成")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取API数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fetch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://birth.kcshen.cn:3002/proxy/huoshan/'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("response")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("json")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'API响应:'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"项目亮点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目亮点"}},[s._v("#")]),s._v(" 项目亮点")]),s._v(" "),t("h3",{attrs:{id:"_1-高度可扩展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-高度可扩展"}},[s._v("#")]),s._v(" 1. 高度可扩展")]),s._v(" "),t("ul",[t("li",[s._v("通过简单的配置即可添加新的API映射")]),s._v(" "),t("li",[s._v("支持任意数量的目标服务器")]),s._v(" "),t("li",[s._v("模块化的中间件设计")])]),s._v(" "),t("h3",{attrs:{id:"_2-开发友好"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-开发友好"}},[s._v("#")]),s._v(" 2. 开发友好")]),s._v(" "),t("ul",[t("li",[s._v("详细的日志输出")]),s._v(" "),t("li",[s._v("完善的错误处理")]),s._v(" "),t("li",[s._v("丰富的文档和示例")])]),s._v(" "),t("h3",{attrs:{id:"_3-生产就绪"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-生产就绪"}},[s._v("#")]),s._v(" 3. 生产就绪")]),s._v(" "),t("ul",[t("li",[s._v("PM2进程管理")]),s._v(" "),t("li",[s._v("健康检查机制")]),s._v(" "),t("li",[s._v("自动重启和监控")]),s._v(" "),t("li",[s._v("安全防护措施")])]),s._v(" "),t("h3",{attrs:{id:"_4-性能优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-性能优化"}},[s._v("#")]),s._v(" 4. 性能优化")]),s._v(" "),t("ul",[t("li",[s._v("请求超时设置")]),s._v(" "),t("li",[s._v("内存使用限制")]),s._v(" "),t("li",[s._v("集群模式支持")])]),s._v(" "),t("h2",{attrs:{id:"实际应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实际应用场景"}},[s._v("#")]),s._v(" 实际应用场景")]),s._v(" "),t("h3",{attrs:{id:"_1-前端开发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-前端开发"}},[s._v("#")]),s._v(" 1. 前端开发")]),s._v(" "),t("ul",[t("li",[s._v("解决跨域问题")]),s._v(" "),t("li",[s._v("统一API接口管理")]),s._v(" "),t("li",[s._v("开发环境代理")])]),s._v(" "),t("h3",{attrs:{id:"_2-微服务架构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-微服务架构"}},[s._v("#")]),s._v(" 2. 微服务架构")]),s._v(" "),t("ul",[t("li",[s._v("API网关功能")]),s._v(" "),t("li",[s._v("服务路由")]),s._v(" "),t("li",[s._v("负载均衡")])]),s._v(" "),t("h3",{attrs:{id:"_3-第三方api集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-第三方api集成"}},[s._v("#")]),s._v(" 3. 第三方API集成")]),s._v(" "),t("ul",[t("li",[s._v("统一管理多个第三方API")]),s._v(" "),t("li",[s._v("简化客户端调用")]),s._v(" "),t("li",[s._v("添加统一的认证和日志")])]),s._v(" "),t("h2",{attrs:{id:"技术挑战与解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#技术挑战与解决方案"}},[s._v("#")]),s._v(" 技术挑战与解决方案")]),s._v(" "),t("h3",{attrs:{id:"_1-跨域问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-跨域问题"}},[s._v("#")]),s._v(" 1. 跨域问题")]),s._v(" "),t("p",[t("strong",[s._v("挑战")]),s._v("：前端直接调用第三方API时遇到CORS限制\n"),t("strong",[s._v("解决方案")]),s._v("：在代理服务器中配置CORS中间件，统一处理跨域请求")]),s._v(" "),t("h3",{attrs:{id:"_2-错误处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-错误处理"}},[s._v("#")]),s._v(" 2. 错误处理")]),s._v(" "),t("p",[t("strong",[s._v("挑战")]),s._v("：需要将目标服务器的错误信息友好地传递给客户端\n"),t("strong",[s._v("解决方案")]),s._v("：实现统一的错误处理中间件，格式化错误响应")]),s._v(" "),t("h3",{attrs:{id:"_3-性能优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-性能优化"}},[s._v("#")]),s._v(" 3. 性能优化")]),s._v(" "),t("p",[t("strong",[s._v("挑战")]),s._v("：高并发场景下的性能问题\n"),t("strong",[s._v("解决方案")]),s._v("：使用PM2集群模式，充分利用多核CPU")]),s._v(" "),t("h3",{attrs:{id:"_4-日志管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-日志管理"}},[s._v("#")]),s._v(" 4. 日志管理")]),s._v(" "),t("p",[t("strong",[s._v("挑战")]),s._v("：需要详细记录代理请求的详细信息\n"),t("strong",[s._v("解决方案")]),s._v("：实现自定义日志中间件，记录请求、响应和错误信息")]),s._v(" "),t("h2",{attrs:{id:"未来规划"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#未来规划"}},[s._v("#")]),s._v(" 未来规划")]),s._v(" "),t("h3",{attrs:{id:"短期目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#短期目标"}},[s._v("#")]),s._v(" 短期目标")]),s._v(" "),t("ul",[t("li",[s._v("[ ] 添加API认证机制")]),s._v(" "),t("li",[s._v("[ ] 实现请求缓存功能")]),s._v(" "),t("li",[s._v("[ ] 添加API限流功能")]),s._v(" "),t("li",[s._v("[ ] 完善监控面板")])]),s._v(" "),t("h3",{attrs:{id:"长期目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#长期目标"}},[s._v("#")]),s._v(" 长期目标")]),s._v(" "),t("ul",[t("li",[s._v("[ ] 支持WebSocket代理")]),s._v(" "),t("li",[s._v("[ ] 添加API版本管理")]),s._v(" "),t("li",[s._v("[ ] 实现动态配置热更新")]),s._v(" "),t("li",[s._v("[ ] 支持负载均衡算法")])]),s._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[s._v("这个统一代理服务器项目是一个功能完整、易于扩展的Node.js解决方案。它不仅解决了跨域问题，还提供了统一的API管理接口，大大简化了前端开发和API集成的复杂度。")]),s._v(" "),t("p",[s._v("项目的核心价值在于：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("简化开发")]),s._v("：统一的接口，减少重复代码")]),s._v(" "),t("li",[t("strong",[s._v("提高效率")]),s._v("：快速集成新的API服务")]),s._v(" "),t("li",[t("strong",[s._v("增强安全")]),s._v("：统一的认证和日志管理")]),s._v(" "),t("li",[t("strong",[s._v("便于维护")]),s._v("：集中的配置和监控")])]),s._v(" "),t("p",[s._v("通过这个项目，我深入学习了Node.js、Express、PM2等技术，也积累了丰富的部署和运维经验。这个项目不仅解决了实际的技术问题，也为未来的项目开发提供了可复用的解决方案。")]),s._v(" "),t("p",[t("strong",[s._v("项目地址：")]),s._v(" "),t("a",{attrs:{href:"http://birth.kcshen.cn:3002/proxy/huoshan/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://birth.kcshen.cn:3002/proxy/huoshan/"),t("OutboundLink")],1)]),s._v(" "),t("hr"),s._v(" "),t("p",[t("em",[s._v("本文档详细介绍了统一代理服务器项目的设计思路、技术实现和部署方案，希望能为有类似需求的开发者提供参考。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);